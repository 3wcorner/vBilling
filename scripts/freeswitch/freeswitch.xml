<document type="freeswitch/xml">

    <X-PRE-PROCESS cmd="set" data="auto_answer=false"/>
    <X-PRE-PROCESS cmd="set" data="domain=$${local_ip_v4}"/>
    <X-PRE-PROCESS cmd="set" data="global_codec_prefs=G722,PCMU,PCMA,GSM,G723,G729"/>
    <X-PRE-PROCESS cmd="set" data="outbound_caller_name=vBilling"/>
    <X-PRE-PROCESS cmd="set" data="outbound_caller_id=0000000000"/>
    <X-PRE-PROCESS cmd="set" data="console_loglevel=alert"/>
    <X-PRE-PROCESS cmd="set" data="call_debug=false"/>
<!--
	Configure better SIP authentication scheme. Currenly SIP authentication is not configured,
	as we allow any SIP call to vBilling and it will take care of it by itself. 
	internal_auth_calls=false will disable all SIP authentication by default.
-->
<X-PRE-PROCESS cmd="set" data="internal_auth_calls=false"/>
<X-PRE-PROCESS cmd="set" data="internal_sip_port=5060"/>

<!--
	START -- Custom Defines
-->
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_host=localhost"/>
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_port=7665"/>
<!--
	END -- Custom Defines
-->
        
<!--
	A temporary hack to locad local configs. FS Configurator is also ready, script needs
	to be revised to be used with.
-->

<section name="configuration" description="Various Configuration">
    <X-PRE-PROCESS cmd="include" data="autoload_configs/*.xml"/>
</section>

<!--
        <configuration name="xml_curl.conf" description="cURL XML Gateway">
            <bindings>
                <binding name="production">
                    <param name="gateway-url" value="$${freeswitch_cofiguration_server}" bindings="$${freeswitch_binding}"/>
                    <param name="gateway-credentials" value="$${freeswitch_cofiguration_server_login}:$${freeswitch_cofiguration_server_password}"/>
                    <param name="auth-scheme" value="digest"/>
                </binding>
            </bindings>
        </configuration>
-->

    </section>

  <section name="dialplan" description="Regex/XML Dialplan">
        <context name="default">
            <extension name="api_authenticated">
                <condition field="destination_number" expression="^(\d+)$">
                    <action application="socket" data="$${vbilling_gateway_host}:$${vbilling_gateway_port} async full"/>
                </condition>
            </extension>
            
            <extension name="api_unauthenticated">
                <condition field="destination_number" expression="^sip:(.*)$">
                    <action application="socket" data="$${vbilling_gateway_host}:$${vbilling_gateway_port} async full"/>
                </condition>
            </extension>
        </context>
    </section>
</document>
