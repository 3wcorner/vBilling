<document type="freeswitch/xml">
    <X-PRE-PROCESS cmd="set" data="auto_answer=false"/>
    <X-PRE-PROCESS cmd="set" data="domain=$${local_ip_v4}"/>
<!--
	Need to work more on better codec management
-->
    <X-PRE-PROCESS cmd="set" data="global_codec_prefs=G722,PCMU,G723,G729,PCMA,GSM"/>
    <X-PRE-PROCESS cmd="set" data="external_rtp_ip=stun:stun.freeswitch.org"/>
    <X-PRE-PROCESS cmd="set" data="external_sip_ip=stun:stun.freeswitch.org"/>
    <X-PRE-PROCESS cmd="set" data="outbound_caller_name=FreeSWITCH"/>
    <X-PRE-PROCESS cmd="set" data="outbound_caller_id=0000000000"/>
    <X-PRE-PROCESS cmd="set" data="console_loglevel=info"/>
    <X-PRE-PROCESS cmd="set" data="call_debug=false"/>
    <X-PRE-PROCESS cmd="set" data="internal_auth_calls=false"/>
    <X-PRE-PROCESS cmd="set" data="internal_sip_port=5060"/>

<!--
	START Custom Defines
-->

    <X-PRE-PROCESS cmd="set" data="vbilling_gateway=localhost"/>
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_port=7665"/>
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_URL=http://localhost/fsConfig/curlrouting.php"/>
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_binding=configuration"/>
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_login=switch_001"/>
    <X-PRE-PROCESS cmd="set" data="vbilling_gateway_password=SomeVerySecretAndRandomPassword"/>

<!--
	END Custom Defines
-->
    
    <section name="configuration" description="Various Configuration">

        <configuration name="modules.conf" description="Modules">
            <modules>
                <load module="mod_console"/>
                <load module="mod_logfile"/>
                <load module="mod_xml_curl"/>
            </modules>
        </configuration>
        
        <configuration name="console.conf" description="Console Logger">
            <mappings>
                <map name="all" value="console,debug,info,notice,warning,err,crit,alert"/>
            </mappings>
            <settings>
                <param name="colorize" value="true"/>
                <param name="loglevel" value="$${console_loglevel}"/>
            </settings>
        </configuration>
        
        <configuration name="logfile.conf" description="File Logging">
            <settings>
                <param name="rotate-on-hup" value="true"/>
            </settings>
            <profiles>
                <profile name="default">
                    <settings>
                        <param name="uuid" value="true" />
                    </settings>
                    <mappings>
                        <map name="all" value="debug,info,notice,warning,err,crit,alert"/>
                    </mappings>
                </profile>
            </profiles>
        </configuration>
        
        <configuration name="xml_curl.conf" description="cURL XML Gateway">
            <bindings>
                <binding name="production">
                    <param name="gateway-url" value="$${vbilling_gateway_URL}" bindings="$${vbilling_gateway_binding}"/>
                    <param name="gateway-credentials" value="$${vbilling_gateway_login}:$${vbilling_gateway_password}"/>
                </binding>
            </bindings>
        </configuration>
        
    </section>
    
    <section name="dialplan" description="Regex/XML Dialplan">
        <context name="default">
            <extension name="api">
                <condition field="destination_number" expression="^(\d+)$">
                    <action application="socket" data="$${vbilling_gateway}:$${vbilling_gateway_port} async full"/>
                </condition>
            </extension>
            
            <extension name="api_sip_uri">
                <condition field="destination_number" expression="^sip:(.*)$">
                    <action application="socket" data="$${vbilling_gateway}:$${vbilling_gateway_port} async full"/>
                </condition>
            </extension>
        </context>
    </section>
</document>
